# RTK6251 Superadmin Password Extractor

Извлечение пароля суперадминистратора из PON-розетки **Rotek RTK6251** (Ростелеком).

## Поддерживаемые устройства

| Модель | Чип | Проверено |
|--------|------|-----------|
| Rotek RTK6251 | Realtek RTL9603 | ✅ |
| Transservice TS-1001GF (клон) | Realtek RTL9603 | Должно работать |

> Другие терминалы на базе RTL9603 с аналогичной прошивкой Ростелеком также могут быть совместимы.

## Предыстория

Оптические GPON-терминалы Ростелеком имеют два уровня доступа:

- **admin** — обычный пользователь с ограниченными правами (логин/пароль на наклейке)
- **superadmin** — полный административный доступ ко всем настройкам

Ростелеком не предоставляет пароль суперадмина ни абонентам, ни монтёрам. Данный скрипт позволяет извлечь его из конфигурационного файла устройства.

## Как это работает

Конфигурация RTK6251 защищена двумя слоями обфускации:

### 1. XOR-шифрование файла конфигурации

Весь файл `config.xml` зашифрован побайтовым XOR с 8-байтовым ключом `tecomtec`.

```
зашифрованный_байт = оригинальный_байт XOR ключ[позиция % 8]
```

### 2. Caesar-обфускация учётных данных

Логины и пароли учётных записей `USER` и `SUSER` дополнительно обфусцированы:

**Кодирование:** реверс строки → сдвиг каждого символа на +1 (Caesar +1)

```
admin → nimda → ojneb
superadmin → nimdarepus → ojnebsfqvt
```

**Декодирование:** сдвиг каждого символа на −1 → реверс строки

```
ojnebsfqvt → nimdarepus → superadmin
YyYyYyYyYyYyYyYyY → XxXxXxXxXxXxXxXxX → XxXxXxXxXxXxXxXxX
```

> **Примечание:** PPPoE-данные и TR-069 учётные записи хранятся в конфиге **без** Caesar-обфускации.

## Установка

```bash
pip install requests
```

## Использование

### Автоматическое скачивание с роутера

```bash
python rtk6251_superadmin.py -L admin -P <пароль_с_наклейки>
```

Скрипт сам подключится к роутеру на `192.168.0.1`, скачает конфиг и расшифрует.

### Указание другого IP-адреса

```bash
python rtk6251_superadmin.py -L admin -P <пароль> -H 192.168.1.1
```

### Работа с уже скачанным конфигом

```bash
python rtk6251_superadmin.py --file config.xml
```

### Сохранение расшифрованного конфига

```bash
python rtk6251_superadmin.py --file config.xml --save
```

Расшифрованный XML будет сохранён в `config_decrypted.xml`.

## Как скачать конфиг вручную

Если автоматическое скачивание не работает:

1. Откройте `http://192.168.0.1` в браузере
2. Войдите под логином `admin` и паролем с наклейки на корпусе
3. Перейдите по адресу:
   ```
   http://192.168.0.1/advanced/conSession.htm?id=666
   ```
4. Скопируйте полученный ключ сессии
5. Перейдите по адресу:
   ```
   http://192.168.0.1/config_old_tl.xgi?sessionKey=ВАШИ_КЛЮЧ
   ```
6. Сохраните скачанный файл как `config.xml`
7. Запустите скрипт:
   ```bash
   python rtk6251_superadmin.py --file config.xml
   ```

## Пример вывода

```
[*] Чтение конфига из файла: config.xml
[*] Размер файла: XXXXX байт
[*] XOR-дешифровка (ключ: tecomtec)...
[+] Конфиг успешно расшифрован!

============================================================
  RTK6251 — Извлечённые учётные данные
============================================================

  ★ СУПЕРАДМИН
    Логин:    superadmin
    Пароль:   xXxXxXxXxXxXxXxX
    (в конфиге: ojnebsfqvt / YyYyYyYyYyYyYyYyY)

  ◆ АДМИН (user)
    Логин:    admin
    Пароль:   aBcD1ef2
    (в конфиге: ojneb / 3gf2EcBb)

  ◆ PPPoE (подключение к интернету)
    Логин:    123456-1@region
    Пароль:   Pa5sW0rD

  ◇ TR-069 (CWMP ACS)
    Логин:    rtk
    Пароль:   rtk

============================================================
  Для входа в веб-интерфейс: http://192.168.0.1
  Используйте логин/пароль суперадмина для полного доступа.
============================================================
```

## Параметры командной строки

| Параметр | Описание |
|----------|----------|
| `-L`, `--login` | Логин администратора (обычно `admin`) |
| `-P`, `--password` | Пароль администратора (с наклейки на корпусе) |
| `-H`, `--host` | IP-адрес роутера (по умолчанию `192.168.0.1`) |
| `-f`, `--file` | Путь к уже скачанному файлу конфигурации |
| `-s`, `--save` | Сохранить расшифрованный конфиг в `config_decrypted.xml` |

## FAQ

**Q: Подойдёт ли для других моделей Rotek (RX-22200, RX-22311)?**
A: Нет. Эти модели используют другой формат шифрования (AES-CBC с моделью роутера в качестве ключа). Для них используйте скрипт [rootkit-sys/RT-GM2-9](https://github.com/rootkit-sys/RT-GM2-9).

**Q: Подойдёт ли для Iskratel RT-GM-3 / RT-GM2-9?**
A: Нет. У них AES-256-CBC с ключом-паролем на основе названия модели. Используйте скрипт выше или метод с 4PDA.

**Q: Пароль суперадмина не подходит!**
A: Возможно, Ростелеком удалённо сменил пароль через TR-069. Попробуйте скачать свежий конфиг и запустить скрипт заново.

**Q: Скрипт выдаёт «не обнаружен XML» после дешифровки**
A: Ваша модель может использовать другой XOR-ключ. Откройте issue или попробуйте ручную дешифровку.

**Q: Зачем нужен суперадмин?**
A: Полный доступ позволяет: настроить проброс портов, сменить режим работы (роутер/мост), включить SSH, отключить TR-069 (удалённое управление провайдером), настроить SIP-телефонию и другие функции, недоступные из обычного интерфейса.

## Отказ от ответственности

Данный инструмент предназначен для получения доступа к **собственному** оборудованию. Автор не несёт ответственности за использование в незаконных целях. Если роутер арендован у провайдера, изменение настроек может нарушить условия договора.

## Благодарности

- Анализ формата конфигурации выполнен совместно с https://github.com/zl0i
- Вдохновлено проектом [rootkit-sys/RT-GM2-9](https://github.com/rootkit-sys/RT-GM2-9)
- Полезные ресурсы: [4PDA](https://4pda.to), [nastroisam.ru](https://nastroisam.ru), [admin-router.ru](https://admin-router.ru)